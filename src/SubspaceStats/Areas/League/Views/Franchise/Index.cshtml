@using SubspaceStats.Areas.League.Authorization
@using SubspaceStats.Areas.League.Models.Franchise
@model List<FranchiseListItem>

@{
	ViewData["Title"] = "Franchises";

	bool isAdministrator = User.IsInRole(RoleNames.Administrator);
}

<style>
	.list-inline-item:not(:last-child)::after {
		content: ",";
		margin: 0;
	}
</style>

@await Html.PartialAsync("_FranchiseNav")

<h1>Franchises</h1>

@if (isAdministrator)
{
	<div class="mb-3">
		<a asp-action="Create" class="mx-2">New Franchise</a>
	</div>
}

<div class="table-responsive">
	<table class="table table-striped table-bordered table-hover">
		<thead>
			<tr>
				<th>Franchise</th>
				<th>Teams</th>
				@if (isAdministrator)
				{
					<th colspan="2">Actions</th>
				}
			</tr>
		</thead>
		<tbody>
			@foreach (var franchise in Model)
			{
				<tr>
					<td><a asp-action="Details" asp-route-franchiseId="@franchise.Id" class="link-underline link-underline-opacity-0 link-underline-opacity-75-hover">@franchise.Name</a></td>
					<td>
						@if(franchise.Teams.Length > 0)
						{
							<ul class="list-inline">
								@foreach(string teamName in franchise.Teams)
								{
									<li class="list-inline-item text-nowrap">@teamName</li>
								}
							</ul>
						}
					</td>
					@if (isAdministrator)
					{
						<td><a asp-action="Edit" asp-route-franchiseId="@franchise.Id">Edit</a></td>
						<td><a asp-action="Delete" asp-route-franchiseId="@franchise.Id">Delete</a></td>
					}
				</tr>
			}
		</tbody>
	</table>
</div>
